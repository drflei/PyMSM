<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<!-- $Id: try02.html 11 2015-07-31 18:30:01Z yves.christophe@aeronomie.be $ -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="mssmarttagspreventparsing" content="true" />
    <link href="img/unilib_logo_16x16.png" rel="shortcut icon" type="image/gif" />
    <link rel="stylesheet" href="print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
    <title>UNILIB</title>
  </head>
  <body>
    <div id="topbar1"><h3 class="small">UNILIB</h3></div>
    <div id="rightcolumn"><div id="content">
      <hr>
      <blockquote><b><font color=red>
        This page essentially documents Unilib version 2.09.
        It may be inaccurate and/or incomplete regarding newer releases!
      </font></b></blockquote>
      <hr>


<!-- BEGIN OF MAIN CONTENT     inside div "rightcolumn/content" -->


	
	<!-- === UNILIB Library  -
      Example 2
   === -->
<!-- End of Head, Begin of Body -->
 <h1>
      Example 2 - evaluation of the (<i>B</i>, <i>L</i>) coordinates
</h1> <h6>
 [ <a href="#description">Description</a>
 | <a href="#source">Source</a>
 | <a href="#results">Results</a>
 <!-- *** Navigation *** -->  
] </h6>
<h2> <a name="description"> Description </a> </h2> <ul>
  Evaluation of the (<i>B</i>, <i>L</i>) coordinates
  at a given geographic location for different times. 
  The magnetic field is described by the combination of
  the DGRF/IGRF 1995 geomagnetic
  model and the Olson &amp; Pfitzer quiet model. The geographic location
  is provided in geodetic coordinates. 
</ul> <h2> <a name="source"> Source </a> </h2> <pre>
      PROGRAM example2
C
      INCLUDE '<a href="structure.html">structure.h</a>'
C
      INTEGER*4    kunit, kinit, ifail, kint, kext, nfbm, i, noprint
      CHARACTER*32 lbint, lbext
      REAL*8       year, param(10), alpha
      REAL*8       fbm, flm, fkm, fsm, fbeq, fs
      TYPE(<a href="structure.html#zdat">ZDAT</a>) mdate
      TYPE(<a href="structure.html#zgeo">ZGEO</a>) mgeod, mpos
C
C     <b>initialisation</b>
C
      DATA kunit, kinit, kint, kext, nfbm, noprint/ 6, 1, 0, 5, 1, -1/
      DATA year, param, alpha/ 1995.0d0, 10*0.0d0, 90.0d0/
C     <b>Note: <code>param</code> is not used when <code>kext</code>=5</b>
C
C     <b>date and time</b>
      mdate%iyear   = 1995
      mdate%imonth  =    1
      mdate%iday    =    1
      mdate%ihour   =    0
      mdate%imin    =    0
      mdate%secs    =    0.0d0
C
C     <b>geodetic location</b>
      mgeod%radius  =20000.0d0 + 6371.2d0
      mgeod%colat   =  120.0d0
      mgeod%elong   =   30.0d0        
C
      CALL <a href="ut990.html">UT990</a> (kunit, kinit, ifail)
      IF( ifail .LT. 0 )STOP
C
      CALL <a href="um510.html">UM510</a> (kint, year, lbint, kunit, ifail)
      IF( ifail .LT. 0 )STOP
C
      CALL <a href="ut540.html">UT540</a> (mdate)          
C
      CALL <a href="um520.html">UM520</a> (kext, mdate%amjd, param,
     :           lbext, kunit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>convert the location from geodetic to geocentric coordinates</b>
C
      CALL <a href="um536.html">UM536</a> (mgeod, mpos)
C
C     <b>loop on the hours</b>
C
      DO i=0, 23
C
C       <b>update the Sun position and the SM coordinates</b>
C
        mdate%ihour =    i
        CALL <a href="ut540.html">UT540</a> (mdate)          
C
        CALL <a href="um522.html">UM522</a> (mdate%amjd, noprint)
        CALL <a href="um524.html">UM524</a> (noprint)
C
C       <b>evaluate the (<i>B</i>, <i>L</i>) coordinates</b>
C
        CALL <a href="ul220.html">UL220</a> (mpos, alpha, nfbm, fbm, flm, fkm, fsm, fbeq, 
     :              fs, ifail)
        IF( ifail .LT. 0 )STOP
C
C       <b>write the result</b>
C
        WRITE(kunit,1001) i, fbm, flm
C
      ENDDO
C
      WRITE(kunit,1002)
C
 1000 FORMAT(
     :  /25('-'),/'RESULT: Magnetic field intensity at mirror points ',
     :   ' and McIlwain shell parameter',
     :  /4x,'hour',15x,'intensity',7x,'shell parameter')
 1001 FORMAT( 4x,i4,2es24.14 )
 1002 FORMAT( /25('-') )
C
      END
</pre> <h2> <a name="results"> Results </a> </h2> <pre>

                                    SPENVIS
                                 UNILIB Library
                                 Version 2.22_YCH_initPrep
                           Generated by SPENVIS team


 --- Main control parameters ---

      UC160 (general constants):
                      Geoid major axis = 6378.16     km
                      Geoid minor axis = 6356.77     km
                Mean Earth radius (Re) = 6371.20     km
                  Ecliptic inclination =   23.441512 deg
                 McIlwain Earth dipole =    0.311653 G/Re^3

      UC190 (field line tracing):
                     Maximum step size =  477.8      km at one Re
              Maximum "last" step size =   15.0      km
                     Minimum step size =    2.0      km
                    Altitude precision =  200.       m
              Magnetic field precision =    0.0006   %

      UC192 (magnetic field evaluation):
             Max. geomagnetic latitude =   85.0      deg
                        Minimum radius =    0.157    Re
            (drift shell tracing):
                        Precision on L =    0.10000  %
            Precision on the longitude =    0.05     deg

 --- Geomagnetic field model ---

      Model ( 0): DGRF 1995                          Epoch 1995.
                             Order + 1 =   11
                     Calculation epoch = 1995.0      year
         Colatitude of the dipole pole =   10.68     deg
          Longitude of the dipole pole =  -71.42     deg
                   Earth dipole moment =    0.302151 G/Re^3
          Correction for the SAA drift =    0.00     deg

 --- External magnetic field model ---

      Model ( 5): Olson-Pfitzer 1977              
           Planetary activity index Kp =    0.0      (magnetopause check)

                                  Date =  01-Jan-1995
                        Universal Time =    0.00     hrs
            Greenwich angle of equinox =  100.18     deg
           GEO direction of the Sun, X =   -0.9200
                                     Y =   -0.0129
                                     Z =   -0.3917
                     Dipole tilt angle =  -25.91     deg

-------------------------
<b>RESULT: Magnetic field intensity at mirror points  and McIlwain shell parameter
    hour               intensity       shell parameter
       0    5.69774556025675E-03    6.44007693668516E+00
       1    5.68399820899698E-03    6.41389680900312E+00
       2    5.66292214425666E-03    6.32303625248843E+00
       3    5.63894247811410E-03    6.21309917466108E+00
       4    5.61459559100788E-03    6.13508047733296E+00
       5    5.59192802270609E-03    6.09113862835756E+00
       6    5.57266307758409E-03    6.04693473516862E+00
       7    5.55658684988412E-03    5.99285569182935E+00
       8    5.54278038765815E-03    5.95386402228482E+00
       9    5.53152545671420E-03    5.94370911313331E+00
      10    5.52378025336341E-03    5.94768432021102E+00
      11    5.52002599772832E-03    5.95121889821842E+00
      12    5.52030423453167E-03    5.95882446333830E+00
      13    5.52481162472806E-03    5.98434505719205E+00
      14    5.53391261730843E-03    6.02690555798865E+00
      15    5.54743998878423E-03    6.07065413771089E+00
      16    5.56429681764972E-03    6.10393010634963E+00
      17    5.58312079429520E-03    6.13860055439532E+00
      18    5.60330044695083E-03    6.19887049004449E+00
      19    5.62504697350314E-03    6.28573555366209E+00
      20    5.64822141533409E-03    6.37033797233338E+00
      21    5.67104712345804E-03    6.41505631921816E+00
      22    5.68979460495423E-03    6.42108808963482E+00
      23    5.69975149975544E-03    6.42729159167912E+00
</b>
-------------------------
</pre>

<!-- +++ Navigation +++ -->
 
<!-- END OF MAIN CONTENT -->
    </div></div>

    <div id="leftcolumn"><div class="moduletable_menu">

        <h3>UNILIB</h3>
        <ul class="menu">
          <li><a alt="Home" href="home.html">Home</a></li>
          <li><a alt="TOC" href="toc.html">TOC</a></li>      
          <li><a alt="Index" href="index.html">Index</a></li>
          <li><a alt="FAQ" href="faq.html">FAQ</a></li>
        </ul>

        <h3>Links</h3>
        <ul class="menu">
          <li><a href="http://www.aeronomie.be/">BIRA-IASB</a></li>
          <li><a href="http://www.spenvis.oma.be/">SPENVIS</a></li>
        </ul>

    </div></div>
    <div id="footer"><div id="rightfooter">
	    <div class="moduletable">Last update: $Date: 2015-07-31 19:30:01 +0100 (Fri, 31 Jul 2015) $</div>
    </div></div>

  </body>
</html>

