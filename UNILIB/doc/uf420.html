<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<!-- $Id: uf420.html 11 2015-07-31 18:30:01Z yves.christophe@aeronomie.be $ -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="mssmarttagspreventparsing" content="true" />
    <link href="img/unilib_logo_16x16.png" rel="shortcut icon" type="image/gif" />
    <link rel="stylesheet" href="print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
    <title>UNILIB</title>
  </head>
  <body>
    <div id="topbar1"><h3 class="small">UNILIB</h3></div>
    <div id="rightcolumn"><div id="content">
      <hr>
      <blockquote><b><font color=red>
        This page essentially documents Unilib version 2.09.
        It may be inaccurate and/or incomplete regarding newer releases!
      </font></b></blockquote>
      <hr>


<!-- BEGIN OF MAIN CONTENT     inside div "rightcolumn/content" -->


	<!-- === UNILIB Library -
      UF420
   === --> 
<!--meta name="keywords" content="magnetic field line segment,mirror point,foot point"-->
<!-- End of Head, Begin of Body -->
 <h1>
      UF420
</h1> <h6>
 [ <a href="#name">Name</a>
 | <a href="#synopsis">Synopsis</a> 
 | <a href="#arguments">Arguments</a> 
 | <a href="#description">Description</a> 
 | <a href="#diagnostics">Diagnostics</a> 
 | <a href="#commonbloks">Common Blocks</a> 
 | <a href="#dependencies">Dependencies</a> 
 | <a href="#seealso">See Also</a> 
 | <a href="#reportedbugs">Reported Bugs</a> 
 | <a href="#examples">Examples</a> 
<!-- *** Navigation *** -->  
] </h6> <h2> <a name="name"> Name </a> </h2> <ul>
      Subroutine UF420 -  trace a magnetic field line segment passing through a given
       position
</ul> <h2> <a name="synopsis"> Synopsis </a> </h2> <pre>
      INTEGER*4     nfbm, ifail
      REAL*8        fbm(nfbm), falt
      TYPE(<a href="structure.html#zgeo">zgeo</a>) mpos
      
      CALL UF420 (mpos, fbm, nfbm, falt, ifail)
</pre> <h2> <a name="arguments"> Arguments </a> </h2> <ul> <dl>
      <dt> <code> mpos      </code> <dd>
      The geographic position (GEO) through which the searched magnetic field line is
      passing  [in]
      <dt> <code> fbm      </code> <dd>
      Boundary conditions on the magnetic field intensity  [in]
      <dt> <code> nfbm      </code> <dd>
      Number of boundary conditions on the magnetic field intensity  [in]
      <dt> <code> falt      </code> <dd>
      Boundary condition on the altitude [in] 
      <dt> <code> ifail      </code> <dd>
       Error flag (see <a href="#diagnostics">diagnostics</a>) [out]     
</dl> </ul> <h2> <a name="description"> Description </a> </h2> <ul>
      The subroutine UF420 traces a magnetic field line segment passing through
      the geographic position <code>mpos</code>.  The magnetic field line
      segment is limited by one of the following boundary conditions :
      <menu>
      <li> the altitude <code>falt</code> has to be reached;
      <li> the magnetic field intensity <code>fbm(1)</code> has to be reached.
      </menu>
      The condition on the altitude can be avoided by setting <code>falt</code> to a value
      lower than -500.
      <p>
      The different points along the field line segment are stored in the
      common block <a href="uc170.html">UC170</a>.  It includes the points
      corresponding to the boundary conditions, as well as, the points
      corresponding to the magnetic field intensities <code>fbm(2)</code>,
      ..., <code>fbm(nfbm)</code>.  Note that the intensities set in the array 
      <code>fbm</code> has to be strictely decreasing : <code>fbm(1)</code> > 
      <code>fbm(2)</code> > <code>fbm(nfbm)</code>.
</ul> <h4>History </h4> <ul>
      From version 1.13 to version 2.00, the algorithm has been
      improved for the case where the first boundary condition on the
      magnetic field intensity is close to the minimum value
      of the magnetic field intensity along the field line segment. 
</ul> <h2> <a name="diagnostics"> Diagnostics </a> </h2> <ul>
      <a name="42001">-42001</a>, incorrect boundary conditions <br>
      <a name="42002">-42002</a> or <a name="42004">-42004</a>,  
      strange behaviour of the field line near the altitude boundary condition<br>
      <a name="42003">-42003</a> or <a name="42006">-42006</a>,
      strange behaviour of <i>B</i> along the field line <br>
      <a name="42005">-42005</a>, 
      problem with the boundary condition on the altitude <br>
      <a name="42007">-42007</a>, 
      problem with the boundary conditions on <i>B</i><br>
      <a name="42008">-42008</a> or <a name="42010">-42010</a>, 
      find the minimum of <i>B</i> before any one of the boundary conditions<br>
      <a name="42009">-42009</a>, 
      too many points along the field line segment<br>
      <a name="42011">-42011</a>,
      error in <a href="uf428.html">UF428</a> detected <i>a posteriori</i>
</ul> <h2> <a name="commonbloks"> Common Blocks </a> </h2> <ul>
      <a href="uc160.html">UC160</a>,
      general constants<br>
      <a href="uc170.html">UC170</a>,
      temporary magnetic field line<br> 
      <a href="uc190.html">UC190</a>,
      control parameters, set 1<br>
</ul> <h2> <a name="dependencies"> Dependencies </a> </h2> 
<h4> Called by </h4> <ul>
     <a href="ul220.html">UL220</a>,
      get information on a magnetic field line segment <br>
     <a href="uf410.html">UF410</a>,
      search the geographic position of a magnetic field line  <br>
      <a href="uf417.html">UF417</a>,
      search the geographic position of a magnetic field line (new) <br>      
     <a href="uf411.html">UF411</a>,
      search a local magnetic equator <br>
</ul> <h4> Calls </h4> <ul>
      <a href="uf421.html">UF421</a>, 
      initialize and close a field line segment <br>
      <a href="uf422.html">UF422</a>, 
      follow a field line until a boundary condition is reached  <br> 
      <a href="uf424.html">UF424</a>, 
      search the lowest <i>B</i> value   <br> 
      <a href="uf429.html">UF429</a>, 
      transpose a field line segment    <br>    
</ul> <h2> <a name="seealso"> See also </a> </h2> <ul>
      <a href="faq05.html">FAQ G.05</a> Which are the coordinates and units used ? <br>
</ul> <h2> <a name="reportedbugs"> Reported Bugs </a> </h2> <ul>
      None
</ul> <h2> <a name="examples"> Examples </a> </h2> <ul>
      <a href="faq06.html">G.06</a> How to start using the UNILIB library ? <br>
</ul> 
<!-- +++ Navigation +++ -->
 
<!-- END OF MAIN CONTENT -->
    </div></div>

    <div id="leftcolumn"><div class="moduletable_menu">

        <h3>UNILIB</h3>
        <ul class="menu">
          <li><a alt="Home" href="home.html">Home</a></li>
          <li><a alt="TOC" href="toc.html">TOC</a></li>      
          <li><a alt="Index" href="index.html">Index</a></li>
          <li><a alt="FAQ" href="faq.html">FAQ</a></li>
        </ul>

        <h3>Links</h3>
        <ul class="menu">
          <li><a href="http://www.aeronomie.be/">BIRA-IASB</a></li>
          <li><a href="http://www.spenvis.oma.be/">SPENVIS</a></li>
        </ul>

    </div></div>
    <div id="footer"><div id="rightfooter">
	    <div class="moduletable">Last update: $Date: 2015-07-31 19:30:01 +0100 (Fri, 31 Jul 2015) $</div>
    </div></div>

  </body>
</html>

