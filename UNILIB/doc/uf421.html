<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<!-- $Id: uf421.html 11 2015-07-31 18:30:01Z yves.christophe@aeronomie.be $ -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="mssmarttagspreventparsing" content="true" />
    <link href="img/unilib_logo_16x16.png" rel="shortcut icon" type="image/gif" />
    <link rel="stylesheet" href="print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
    <title>UNILIB</title>
  </head>
  <body>
    <div id="topbar1"><h3 class="small">UNILIB</h3></div>
    <div id="rightcolumn"><div id="content">
      <hr>
      <blockquote><b><font color=red>
        This page essentially documents Unilib version 2.09.
        It may be inaccurate and/or incomplete regarding newer releases!
      </font></b></blockquote>
      <hr>


<!-- BEGIN OF MAIN CONTENT     inside div "rightcolumn/content" -->


	<!-- === UNILIB Library -
      UF421
   === --> 
<!--meta name="keywords" content="internal subroutine,Runge-Kutta"-->
<!-- End of Head, Begin of Body -->
 <h1>
      UF421
</h1> <h6>
 [ <a href="#name">Name</a>
 | <a href="#synopsis">Synopsis</a> 
 | <a href="#arguments">Arguments</a> 
 | <a href="#description">Description</a> 
 | <a href="#diagnostics">Diagnostics</a> 
 | <a href="#commonbloks">Common Blocks</a> 
 | <a href="#dependencies">Dependencies</a> 
 | <a href="#seealso">See Also</a> 
 | <a href="#reportedbugs">Reported Bugs</a> 
 | <a href="#examples">Examples</a> 
<!-- *** Navigation *** -->  
] </h6> <h2> <a name="name"> Name </a> </h2> <ul>
      Subroutine UF421 - initialize and close a field line segment
</ul> <h2> <a name="synopsis"> Synopsis </a> </h2> <pre>
      REAL*8       pb, palt, plen
      INTEGER*4    ifail, jind, kiniclo
      TYPE(<a href="structure.html#zgeo">zgeo</a>) mgeo
      
      CALL UF421 (kiniclo, mgeo, pb, palt, plen, jind, ifail)
</pre> <h2> <a name="arguments"> Arguments </a> </h2> <ul> <dl>
      <dt> <code> kiniclo      </code> <dd>
      Flag to select initialisation or closing (1 or 2 resp.) [in]
      <dt> <code> mgeo         </code> <dd>
      geographic location of the start or end point [in/out]
      <dt> <code> pb           </code> <dd>
      Magnetic field intensity at <code>mgeo</code> [out]
      <dt> <code> palt         </code> <dd>
      Altitude of <code>mgeo</code> [out]
      <dt> <code> plen         </code> <dd>
      Arc length of the field line segment [out]
      <dt> <code> jind         </code> <dd>
      Index in the common block <a href="uc170.html">UC170</a> [out]
      <dt> <code> ifail        </code> <dd>
      Error flag (see <a href="#diagnostics">diagnostics</a>) [out]
</dl> </ul> <h2> <a name="description"> Description </a> </h2> <ul>
      When the argument <code>kiniclo</code> is equal to 1, the subroutine UF421 
      initializes the common block <a href="uc170.html">UC170</a> to store a magnetic field
      line segment which starts at <code>mgeo</code>. As result, the arguments 
      <code>pb</code> and <code>palt</code> are set to the magnetic
      field intensity and altitude of <code>mgeo</code>.   The arguments 
      <code>plen</code> and <code>jind</code> are set to 0.0 and 1, respectively.
      <p>
      When the argument <code>kiniclo</code> is equal to 2, the subroutine UF421
      closes the magnetic field line segment stored in the common
      block <a href="uc170.html">UC170</a>.  As result, the arguments <code>mgeo</code>, <code>pb</code>
      and <code>palt</code> are set to the geographic location of the last point,
      its magnetic field intensity and  altitude, respectively.  The total arc length
      of the field line segment and the total number of points stored in  the
      common block are returned by the arguments <code>plen</code> and
      <code>jind</code>, respectively.
      
       
</ul> <h2> <a name="diagnostics"> Diagnostics </a> </h2> <ul>
      <a name="42101">-42101</a>, not used<br>
      <a name="42102">-42102</a>, the size of the common block
      <a href="uc170.html">UC170</a> has been overrun <br>
      <a name="42103">-42103</a>, problem with the field line
       description <br>
</ul> <h2> <a name="commonbloks"> Common Blocks </a> </h2> <ul>
      <a href="uc160.html">UC160</a>, 
      general constants <br> 
      <a href="uc170.html">UC170</a>,
      temporary magnetic field line <br>
      <a href="uc190.html">UC190</a>,
      control parameters, set 1 <br>


</ul> <h2> <a name="dependencies"> Dependencies </a> </h2> 
<h4> Called by </h4> <ul>
      <a href="uf420.html">UF420</a>, 
      trace a magnetic field line segment passing through a given
      position <br>
</ul> <h4> Calls </h4> <ul>
      <a href="um530.html">UM530</a>, 
      evaluate the magnetic field vector <br>
      <a href="ut999.html">UT999</a>, 
      radius of curvature in a dipolar magnetic field <br>     
</ul> <h2> <a name="seealso"> See also </a> </h2> <ul>
      None
</ul> <h2> <a name="reportedbugs"> Reported Bugs </a> </h2> <ul>
      None
</ul> <h2> <a name="examples"> Examples </a> </h2> <ul>
      None
</ul> 
<!-- +++ Navigation +++ -->
 
<!-- END OF MAIN CONTENT -->
    </div></div>

    <div id="leftcolumn"><div class="moduletable_menu">

        <h3>UNILIB</h3>
        <ul class="menu">
          <li><a alt="Home" href="home.html">Home</a></li>
          <li><a alt="TOC" href="toc.html">TOC</a></li>      
          <li><a alt="Index" href="index.html">Index</a></li>
          <li><a alt="FAQ" href="faq.html">FAQ</a></li>
        </ul>

        <h3>Links</h3>
        <ul class="menu">
          <li><a href="http://www.aeronomie.be/">BIRA-IASB</a></li>
          <li><a href="http://www.spenvis.oma.be/">SPENVIS</a></li>
        </ul>

    </div></div>
    <div id="footer"><div id="rightfooter">
	    <div class="moduletable">Last update: $Date: 2015-07-31 19:30:01 +0100 (Fri, 31 Jul 2015) $</div>
    </div></div>

  </body>
</html>

