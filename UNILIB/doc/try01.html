<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<!-- $Id: try01.html 11 2015-07-31 18:30:01Z yves.christophe@aeronomie.be $ -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="mssmarttagspreventparsing" content="true" />
    <link href="img/unilib_logo_16x16.png" rel="shortcut icon" type="image/gif" />
    <link rel="stylesheet" href="print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
    <title>UNILIB</title>
  </head>
  <body>
    <div id="topbar1"><h3 class="small">UNILIB</h3></div>
    <div id="rightcolumn"><div id="content">
      <hr>
      <blockquote><b><font color=red>
        This page essentially documents Unilib version 2.09.
        It may be inaccurate and/or incomplete regarding newer releases!
      </font></b></blockquote>
      <hr>


<!-- BEGIN OF MAIN CONTENT     inside div "rightcolumn/content" -->


	<!-- === UNILIB Library  -
      Example 1
   === -->
<!-- End of Head, Begin of Body -->
 <h1>
      Example 1 - evaluation of the magnetic field vector
</h1> <h6>
 [ <a href="#description">Description</a>
 | <a href="#source">Source</a>
 | <a href="#results">Results</a>
 <!-- *** Navigation *** -->  
] </h6>
<h2> <a name="description"> Description </a> </h2> <ul>
  Evaluation of the magnetic field vector at a given geographic
  location. The magnetic field is described by the combination of
  the DGRF/IGRF 1995 geomagnetic
  model and the Olson & Pfitzer dynamic model. The geographic location
  is provided in geodetic coordinates. 
</ul> <h2> <a name="source"> Source </a> </h2> <pre>
      PROGRAM example1
C
      INCLUDE '<a href="structure.html">structure.h</a>'
C
      INTEGER*4    kunit, kinit, ifail, kint, kext
      CHARACTER*32 lbint, lbext
      REAL*8       year, param(10)
      TYPE(<a href="structure.html#zdat">ZDAT</a>) mdate
      TYPE(<a href="structure.html#zgeo">ZGEO</a>) mgeod, mpos
      TYPE(<a href="structure.html#zvec">ZVEC</a>) mb
C
C     <b>initialize variables</b>
C
      DATA kunit, kinit/ 6, 1/
      DATA kint, kext/ 0, 6/
      DATA year, param/ 1995.d0, 0.d0, -30.d0, 0.d0, 25.d0, 300.d0, 
     :                           0.d0, 0.d0, 0.d0, 0.d0, 0.d0/
C
C     <b>initialize the library</b>
C
C
      CALL <a href="ut990.html">UT990</a> (kunit, kinit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>set the geomagnetic field model</b>
C     <b>(kint=0, DGRF/IGRF)</b>
C
      CALL <a href="um510.html">UM510</a> (kint, year, lbint, kunit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>set date and time</b>
C
      mdate%iyear   = 1995
      mdate%imonth  =    1
      mdate%iday    =    1
      mdate%ihour   =    0
      mdate%imin    =    0
      mdate%secs    =    0.0d0
C
C     <b>compute the modified julian day</b>
C     <b>(based on January 1, 1950)</b>
C
      CALL <a href="ut540.html">UT540</a> (mdate)          
C
C     <b>set the external magnetic field model</b>
C     <b>(kext=6, Olson et Pfizer dynamic)</b>
C
      CALL <a href="um520.html">UM520</a> (kext, mdate%amjd, param,
     :           lbext, kunit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>set the geographic location</b>
C
      mgeod%radius  =  300.0d0 + 6371.2d0
      mgeod%colat   =  120.0d0
      mgeod%elong   =   30.0d0
C
C     <b>convert from geodetic to geocentric</b>
C
      CALL <a href="um536.html">UM536</a> (mgeod, mpos)
C
C     <b>evaluate the magnetic field vector</b>
C
      CALL <a href="um530.html">UM530</a> (mpos, mb, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>write the result</b>
C
      WRITE(kunit,1000) mb%dnrm, mb%rho, mb%theta, mb%phi
C
 1000 FORMAT(
     :  /'RESULT: magnetic field',/25x,
     :               'norm =', g, ' Gauss',/,13x,
     :   'radial component =', g, ' Gauss',/,13x
     :   'along colatitude =', g, ' Gauss',/,14x
     :    'along longitude =', g, ' Gauss' )
C
      END
</pre> <h2> <a name="results"> Results </a> </h2> <pre>

                                    SPENVIS
                                 UNILIB Library
                                 Version 2.22_YCH_initPrep
                           Generated by SPENVIS team


 --- Main control parameters ---

      UC160 (general constants):
                      Geoid major axis = 6378.16     km
                      Geoid minor axis = 6356.77     km
                Mean Earth radius (Re) = 6371.20     km
                  Ecliptic inclination =   23.441512 deg
                 McIlwain Earth dipole =    0.311653 G/Re^3

      UC190 (field line tracing):
                     Maximum step size =  477.8      km at one Re
              Maximum "last" step size =   15.0      km
                     Minimum step size =    2.0      km
                    Altitude precision =  200.       m
              Magnetic field precision =    0.0006   %

      UC192 (magnetic field evaluation):
             Max. geomagnetic latitude =   85.0      deg
                        Minimum radius =    0.157    Re
            (drift shell tracing):
                        Precision on L =    0.10000  %
            Precision on the longitude =    0.05     deg

 --- Geomagnetic field model ---

      Model ( 0): DGRF 1995                          Epoch 1995.
                             Order + 1 =   11
                     Calculation epoch = 1995.0      year
         Colatitude of the dipole pole =   10.68     deg
          Longitude of the dipole pole =  -71.42     deg
                   Earth dipole moment =    0.302151 G/Re^3
          Correction for the SAA drift =    0.00     deg

 --- External magnetic field model ---

      Model (6): Olson-Pfitzer dynamic           
              Storm activity index Dst =  -30.0      nT
                    Solar wind density =   25.0      1/cm^3
                   Solar wind velocity =  300.0      km/s
                     Standoff distance =    8.6      Re
           Planetary activity index Kp =    0.0      (magnetopause check)

                                  Date =  01-Jan-1995
                        Universal Time =    0.00     hrs
            Greenwich angle of equinox =  100.18     deg
           GEO direction of the Sun, X =   -0.9200
                                     Y =   -0.0129
                                     Z =   -0.3917
                     Dipole tilt angle =  -25.91     deg

-------------------------
<b>RESULT: magnetic field
                         norm =   2.567571783908246E-01 gauss
             radial component =   2.283426241361413E-01 gauss
             along colatitude =  -1.097868129720019E-01 gauss
              along longitude =  -4.160228786123785E-02 gauss</b>
-------------------------
</pre> 
<!-- +++ Navigation +++ -->
 
<!-- END OF MAIN CONTENT -->
    </div></div>

    <div id="leftcolumn"><div class="moduletable_menu">

        <h3>UNILIB</h3>
        <ul class="menu">
          <li><a alt="Home" href="home.html">Home</a></li>
          <li><a alt="TOC" href="toc.html">TOC</a></li>      
          <li><a alt="Index" href="index.html">Index</a></li>
          <li><a alt="FAQ" href="faq.html">FAQ</a></li>
        </ul>

        <h3>Links</h3>
        <ul class="menu">
          <li><a href="http://www.aeronomie.be/">BIRA-IASB</a></li>
          <li><a href="http://www.spenvis.oma.be/">SPENVIS</a></li>
        </ul>

    </div></div>
    <div id="footer"><div id="rightfooter">
	    <div class="moduletable">Last update: $Date: 2015-07-31 19:30:01 +0100 (Fri, 31 Jul 2015) $</div>
    </div></div>

  </body>
</html>

