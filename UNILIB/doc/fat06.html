<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<!-- $Id: fat06.html 11 2015-07-31 18:30:01Z yves.christophe@aeronomie.be $ -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="mssmarttagspreventparsing" content="true" />
    <link href="img/unilib_logo_16x16.png" rel="shortcut icon" type="image/gif" />
    <link rel="stylesheet" href="print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
    <title>UNILIB</title>
  </head>
  <body>
    <div id="topbar1"><h3 class="small">UNILIB</h3></div>
    <div id="rightcolumn"><div id="content">
      <hr>
      <blockquote><b><font color=red>
        This page essentially documents Unilib version 2.09.
        It may be inaccurate and/or incomplete regarding newer releases!
      </font></b></blockquote>
      <hr>


<!-- BEGIN OF MAIN CONTENT     inside div "rightcolumn/content" -->


	<!-- === UNILIB Library - 
      FAQ T.06
   === --> 
<!--meta name="Keywords" content="Precision,Magnetic dipole"-->
<!-- End of Head, Begin of Body -->
 <h1>
      Frequently Asked Questions
</h1><h6>
 [ <a href="#question">Question</a> 
 | <a href="#answer">Answer</a> 
 | <a href="#illustration">Illustration</a> 
 | <a href="#seealso">See Also</a> 
<!-- *** Navigation *** -->  
] </h6> <h2> <a name="question"> Question </a> </h2> <ul> 
      T.06 - What is the precision of the field line tracing algorithm ?
</ul> <h2> <a name="answer"> Answer </a> </h2> <ul>
  The evaluation of the UNILIB library precision,
  is performed by two shell tracings:
<ol><li>with a centered aligned magnetic dipole;
<li>with the same magnetic field as the Hassitt code <code>RHOBAR</code>. 
</ol>
</ul> <h4> Aligned dipole </h4> <ul>
  For the centered aligned magnetic dipole, only the element
  <i>g</i><sub>1</sub><sup>0</sup> of the spherical harmonic
  coefficients is different from zero.  In this case the value
  of <i>g</i><sub>1</sub><sup>0</sup> is chosen such that the
  moment of the magnetic dipole is equal to the value used by
  McIlwain, i.e. 0.311653 G Re<sup>-3</sup>.  In the library,
  the drift shell tracing is controlled by the arguments <code>prop</code>, 
  <code>stepx</code>, <code>stplst</code>, <code>epsrel</code>, 
  <code>epsfl</code> and <code>epslon</code>
  of the common blocks <a href="uc190.html">UC190</a> and
  <a href="uc192.html">UC192</a>.  
<p>
  As a test case, the drift shell 
  (<i>B</i>=0.3,<i>L</i>=1.5) has been computed by the subroutine
  <a href="ud310.html">UD310</a> (with <code>knfl</code> set to 360)
  for two cases:
  <ul>
  <li>when the default values
  of the controlling parameters (<code>prop</code> = 0.2, 
  <code>stepx</code> = 0.075, 
  <code>stplst</code> = 15.0, <code>epsrel</code> = 6.0 10<sup>-6</sup>, 
  <code>epsfl</code> = 0.001 and <code>epslon</code> = 0.05) are used;
  <li>when the argument <code>prop</code>, which controls the step
      size along the field line, is divided by two
      (<code>prop</code> = 0.1).
  </ul>
  In each case, the 360 magnetic field line segments are identical 
  due to the axial symmetry.
  The geocentric spherical coordinates of the computed points for the 
  magnetic field line segment
  at 90 deg. of longitude are displayed in the table below for  both cases.
  The segments computed with
  <code>prop</code> = 0.2 include 23 points while the segments computed
  when <code>prop</code> = 0.1 include 35 points.
  19 values have been theoretically calculated for the same field line
  and are also given in the table.
<p>
<center><table cellspacing=0 border=1>       
<tr><th colspan=3><code>prop</code> = 0.2</th>
    <th colspan=3><code>prop</code> = 0.1</th>
    <th colspan=3>theory</th></tr>
<tr><th><i>rho</i><br>(Re)</th><th><i>theta</i><br>(rad)</th><th><i>B</i><br>(Gauss)</th>
<th><i>rho</i><br>(Re)</th><th><i>theta</i><br>(rad)</th><th><i>B</i><br>(Gauss)</th>
<th><i>rho</i><br>(Re)</th><th><i>theta</i><br>(rad)</th><th><i>B</i><br>(Gauss)</th>
</tr>
<tr><td></td><td></td><td>                          <td>1.1139</td><td>1.03948</td><td>0.300000    </td></tr>
<tr><td></td><td></td><td>                          <td>1.1155</td><td>1.04071</td><td>0.298428    </td></tr>
<tr><td></td><td></td><td>                          <td>1.1354</td><td>1.05604</td><td>0.279835    </td></tr>
<tr><td></td><td></td><td>                          <td>1.1899</td><td>1.09964</td><td>0.235339    </td></tr>
<tr><td></td><td></td><td>                          <td>1.2392</td><td>1.14168</td><td>0.201867    </td></tr>
<tr><td></td><td></td><td>                          <td>1.2836</td><td>1.18227</td><td>0.176261    </td></tr> 
<tr><td>1.1139</td><td>1.03946</td><td>0.300000</td><td>1.3231</td><td>1.22153</td><td>0.156399    </td></tr>
<tr><td>1.1155</td><td>1.04069</td><td>0.298428</td><td>1.3580</td><td>1.25948</td><td>0.140867    </td></tr>
<tr><td>1.1465</td><td>1.06468</td><td>0.270055</td><td>1.3886</td><td>1.29635</td><td>0.128593</td><td>1.1141</td><td>1.03884</td><td>0.300000  </td></tr>
<tr><td>1.2120</td><td>1.11810</td><td>0.219634</td><td>1.4150</td><td>1.33228</td><td>0.118861</td><td>1.1889</td><td>1.09794</td><td>0.236219  </td></tr>
<tr><td>1.2761</td><td>1.17516</td><td>0.180326</td><td>1.4375</td><td>1.36741</td><td>0.111155</td><td>1.2575</td><td>1.15705</td><td>0.190964  </td></tr>
<tr><td>1.3370</td><td>1.23608</td><td>0.150045</td><td>1.4563</td><td>1.40188</td><td>0.105101</td><td>1.3191</td><td>1.21616</td><td>0.158439  </td></tr>
<tr><td>1.3922</td><td>1.30095</td><td>0.127222</td><td>1.4715</td><td>1.43583</td><td>0.100432</td><td>1.3728</td><td>1.27526</td><td>0.134933  </td></tr>
<tr><td>1.4388</td><td>1.36959</td><td>0.110720</td><td>1.4833</td><td>1.46942</td><td>0.096955</td><td>1.4177</td><td>1.33437</td><td>0.118032  </td></tr>
<tr><td>1.4718</td><td>1.43652</td><td>0.100341</td><td>1.4917</td><td>1.50278</td><td>0.094537</td><td>1.4533</td><td>1.39348</td><td>0.106159  </td></tr>
<tr><td>1.4918</td><td>1.50282</td><td>0.094527</td><td>1.4968</td><td>1.53606</td><td>0.093098</td><td>1.4791</td><td>1.45258</td><td>0.098293  </td></tr>
<tr><td>1.4987</td><td>1.56938</td><td>0.092587</td><td>1.4986</td><td>1.56938</td><td>0.092595</td><td>1.4948</td><td>1.51169</td><td>0.093802  </td></tr>
<tr><td><font color=magenta>1.4987</font></td>
    <td><font color=magenta>1.57080</font></td>
    <td><font color=magenta>0.092586</font></td>
    <td><font color=magenta>1.4986</font></td>
    <td><font color=magenta>1.57080</font></td>
    <td><font color=magenta>0.092594</font>
    <td><font color=magenta>1.5000</font></td>
    <td><font color=magenta>1.57080</font></td>
    <td><font color=magenta>0.092342</font></td></tr>
<tr><td>1.4987</td><td>1.57221</td><td>0.092587</td><td>1.4986</td><td>1.57221</td><td>0.092595</td><td>1.4948</td><td>1.62990</td><td>0.093802  </td></tr>
<tr><td>1.4918</td><td>1.63877</td><td>0.094527</td><td>1.4968</td><td>1.60553</td><td>0.093098</td><td>1.4791</td><td>1.68901</td><td>0.098293  </td></tr>
<tr><td>1.4718</td><td>1.70507</td><td>0.100341</td><td>1.4917</td><td>1.63881</td><td>0.094537</td><td>1.4533</td><td>1.74812</td><td>0.106159  </td></tr>
<tr><td>1.4388</td><td>1.77200</td><td>0.110720</td><td>1.4833</td><td>1.67217</td><td>0.096955</td><td>1.4177</td><td>1.80722</td><td>0.118032  </td></tr>
<tr><td>1.3922</td><td>1.84065</td><td>0.127222</td><td>1.4715</td><td>1.70576</td><td>0.100432</td><td>1.3728</td><td>1.86633</td><td>0.134933  </td></tr>
<tr><td>1.3370</td><td>1.90551</td><td>0.150045</td><td>1.4563</td><td>1.73971</td><td>0.105101</td><td>1.3191</td><td>1.92543</td><td>0.158439  </td></tr>
<tr><td>1.2761</td><td>1.96643</td><td>0.180326</td><td>1.4375</td><td>1.77418</td><td>0.111155</td><td>1.2575</td><td>1.98454</td><td>0.190964  </td></tr>
<tr><td>1.2120</td><td>2.02350</td><td>0.219634</td><td>1.4150</td><td>1.80931</td><td>0.118861</td><td>1.1889</td><td>2.04365</td><td>0.236219  </td></tr>
<tr><td>1.1465</td><td>2.07691</td><td>0.270055</td><td>1.3886</td><td>1.84524</td><td>0.128593</td><td>1.1141</td><td>2.10275</td><td>0.300000  </td></tr>
<tr><td>1.1155</td><td>2.10090</td><td>0.298428</td><td>1.3580</td><td>1.88212</td><td>0.140867    </td></tr>
<tr><td>1.1139</td><td>2.10213</td><td>0.300000</td><td>1.3231</td><td>1.92006</td><td>0.156399    </td></tr>
<tr><td></td><td></td><td>                     </td><td>1.2836</td><td>1.95932</td><td>0.176261    </td></tr>
<tr><td></td><td></td><td>                     </td><td>1.2392</td><td>1.99991</td><td>0.201867    </td></tr>
<tr><td></td><td></td><td>                     </td><td>1.1899</td><td>2.04195</td><td>0.235339    </td></tr>
<tr><td></td><td></td><td>                     </td><td>1.1354</td><td>2.08556</td><td>0.279835    </td></tr>
<tr><td></td><td></td><td>                     </td><td>1.1155</td><td>2.10088</td><td>0.298428    </td></tr>
<tr><td></td><td></td><td>                     </td><td>1.1139</td><td>2.10211</td><td>0.300000    </td></tr>
<tr><td colspan=9 align=center>Results obtained with UNILIB v 1.11</td></tr>
</table></center>
<p>
  The discrepancies at the equatorial point reflect mainly the
  dimness in the evaluation of <i>L</i>. The second table below
  shows the values of the McIlwain parameter obtained by the library
  for field line segments limited by the magnetic field intensity
  <i>B</i> = 0.3 G as a function of the crossing distance
  at the equatorial plane.  The results are obtained at 90 deg. of longitude
  with
  the default controlling parameters (<code>prop</code> = 0.2)
  by using subroutines <a href="uf420.html">UF420</a>, 
  <a href="ul230.html">UL230</a> and <a href="ul240.html">UL240</a>.
<p>
<center><table cellspacing=0 border=1>       
<tr><th>Equatorial crossing</th>
    <th><i>I</i></th>
    <th><i>L</i></th>
    <th><i>B</i> at the equator</th></tr>
<tr><td>1.45000</td><td>6632.9</td><td>1.44949</td><td>0.102227</td></tr>
<tr><td>1.50000</td><td>7436.3</td><td>1.49975</td><td>0.092342</td></tr>
<tr><td>1.50025</td><td>7440.3</td><td>1.50000</td><td>0.092295</td></tr>
<tr><td>1.55000</td><td>8237.0</td><td>1.54950</td><td>0.083691</td></tr>
<tr><td>2.00000</td><td>15661.3</td><td>1.99984</td><td>0.038957</td></tr>
<tr><td>2.50000</td><td>24126.1</td><td>2.49998</td><td>0.019946</td></tr>
</table></center>
<p>
   For each equatorial crossing distance, a slight systematic error
   appears in the computation of <i>L</i>. This error is more important
   at lower <i>L</i>. Nevertheless one should note that at <i>L</i>
   = 1.5, the error is only about 1.5 km.
<p>
   The value of the Roederer shell parameter associated with
   the drift shell (<i>B</i>=0.3,<i>L</i>=1.5) obtained by
   the library (subroutine <a href="ud330.html">UD330</a>) with the 
   default controlling parameters
   is equal to 1.4986. This value has to be compared with the 
   crossing distance at the equator, which is equal to 1.4987.
   We assume therefore that the slight systematic error observed
   in the tables above for the value of the McIlwain parameter is 
   mainly due to
   the subroutines <a href="ul240.html">UL240</a> and 
   <a href="ul242.html">UL242</a>.
</ul> <h4> Comparison with RHOBAR</h4> <ul>
   RHOBAR is a Fortran code developped by A. Hassitt and C.E.
   McIlwain in the sixties.  This programme can be used to
   evaluate an average atmospheric densities over a magnetic
   drift shell. The programme is restricted to the Jensen &amp;
   Cain geomagnetic field model.  The strategies of the
   programme RHOBAR and of the library UNILIB to trace a magnetic
   drift shell widely differs. In UNILIB, the field line segments
   computed by subroutine <a href="ud310.html">UD310</a> are equally
   spaced in longitude and the number of segments is controlled
   by the user, e.g. 270.  In the programme RHOBAR, the first few
   segments are equally spaced in longitude.  The other segments
   are only traced at longitudes where the average densities
   is the more varying, i.e. at longitudes where the magnetic field
   lines reach lower altitudes.  The programme RHOBAR 
   makes also use of interpolation to determine the 
   altitude of the mirror points.  In consequence, the RHOBAR
   is better optimized to search the mirror point with the lowest
   altitude on a magnetic drift shell than the UNILIB library.
   On the other hand, the programme RHOBAR is restricted to the
   evaluation of the average density for a given magnetic field
   and atmospheric model, and, a part of its algorithm 
   seems to be especially tuned for the Jensen and Cain
   geomagnetic field model.
<p>
   To evaluate the precision of the drift shell tracing,
   the mirror points with the lowest altitude have been
   searched for different magnetic drift shells using
   the subroutine <a href="ud310.html">UD310</a> with
   120, 270 or 360 field line segments, and using the
   programme RHOBAR. The results are displayed in the table 
   below. The UNILIB library has been initialized
   with the same geomagnetic field model as used in
   the programme RHOBAR.
<p>
<center><table cellspacing=0 border=1>
<tr><th><i>B</i></th><th><i>L</i></th><th>UD310, 120</th><th>UD310, 270</th><th>UD310, 360</th><th>RHOBAR</th></tr>
<tr><td>0.400</td><td>4.60</td><td>115.9 </td><td>113.4 </td><td>113.3 </td><td>122.6 </td></tr>
<tr><td>0.350</td><td>3.60</td><td>188.9 </td><td>181.4 </td><td>171.0 </td><td>184.2 </td></tr>
<tr><td>0.275</td><td>2.10</td><td>194.9 </td><td>203.4 </td><td>218.5 </td><td>223.9 </td></tr>
<tr><td>0.375</td><td>4.60</td><td>250.6 </td><td>254.5 </td><td>251.2 </td><td>267.8 </td></tr>
<tr><td>0.350</td><td>4.10</td><td>294.7 </td><td>315.8 </td><td>311.8 </td><td>321.7 </td></tr>
<tr><td>0.350</td><td>4.60</td><td>401.3 </td><td>420.5 </td><td>419.3 </td><td>428.0 </td></tr>
<tr><td>0.225</td><td>1.60</td><td>442.8 </td><td>460.6 </td><td>474.0 </td><td>481.4 </td></tr>
<tr><td>0.250</td><td>2.10</td><td>489.5 </td><td>489.8 </td><td>489.6 </td><td>487.9 </td></tr>
<tr><td>0.350</td><td>5.10</td><td>486.0 </td><td>494.3 </td><td>504.9 </td><td>512.4 </td></tr>
<tr><td>0.325</td><td>4.60</td><td>607.5 </td><td>603.9 </td><td>595.8 </td><td>605.4 </td></tr>
<tr><td>0.225</td><td>2.10</td><td>742.4 </td><td>772.6 </td><td>764.7 </td><td>777.8 </td></tr>
<tr><td>0.225</td><td>2.60</td><td>977.8 </td><td>1002.7 </td><td>1002.9 </td><td>1003.2 </td></tr>
<tr><td>0.200</td><td>2.10</td><td>1088.5 </td><td>1090.9 </td><td>1099.7 </td><td>1111.5 </td></tr>
<tr><td>0.225</td><td>3.10</td><td>1197.3</td><td>1175.5 </td><td>1180.8 </td><td>1195.2 </td></tr>
</table></center>
<p>
  The UNILIB results are obtained with the version 1.12 of the library.
  The discrepancies that remain sometimes between the results are mainly
  due to an incorrect use of the Jensen &amp; Cain magnetic field
  model (Heynderickx et al., 1994) by the RHOBAR programme.  
  This error gets its main effect at
  the mid latitudes.
</ul> <h4> References </h4> <ul>   
     <li>Heynderickx, D., Lemaire, J., and Daly, E.J.,
     <i>Historical review of the different procedures used to compute the L
     parameter</i>, Aeronomica Acta A-Nb <b>380</b> (1994),
     J. Nuclear Tracks Radiat. Meas. (1995)                 
</ul> <h2> <a name="illustration"> Illustration </a> </h2> <ul>   
  The subroutine <code>faqt06</code> is used to initialize the UNILIB
  library with a centered magnetic field dipole aligned with the
  Earth's axis.
</ul> <h4> Source </h4> <pre>
      SUBROUTINE faqt06 (kunit, ifail)
C
C     <b>Initialization of the UNILIB library with a</b>
C     <b>aligned centered magnetic dipole</b>
C
      INTEGER*4      kunit, ifail 
C
      include '<a href="structure.html">structure.h</a>'
C
      COMMON /<a href="uc140.html">UC140</a>/  mint, mext, msun
C      
      TYPE(<a href="structure.html#zimf">zimf</a>) mint
      TYPE(<a href="structure.html#zsun">zsun</a>) msun
      TYPE(<a href="structure.html#zemf">zemf</a>) mext          
C
      COMMON /<a href="uc160.html">UC160</a>/ pi, deg, re, gmagmo, eclipt, geoid, uma
C
      REAL*8         pi, deg, re
      REAL*8         gmagmo
      REAL*8         eclipt, geoid(3), uma(30)    
C
      REAL*8         amjd, param(10)
      INTEGER*4      kext, kinit, iver
      CHARACTER*32   lbext
C
      DATA kinit, kext, amjd, param/ 1, 0, 0.0d0, 10*0.0d0/
C
      ifail       = 0
C
C     <b>Initialize UNILIB</b>
C
      CALL <a href="ut990.html">UT990</a> ( kunit, kinit, ifail )
      if( ifail.lt.0 )return
      iver        = ifail
C
C     <b>Initialize the geomagnetic field model</b>
C
      mint.kinner = -1
C                   <b> any value less than 4 and not equal to 1</b>
      mint.label  = 'Aligned Dipolar magnetic field  '
      mint.tzero  = 1960.0d0
      mint.epoch  = 1960.0d0
      mint.saarot = 0.0d0
      mint.elong  = 0.0d0
      mint.colat  = 0.0d0
C
      mint.norder = 2         
      mint.gmmo   = gmagmo
      mint.coef(2,1) = 1.0D+5 * gmagmo
      mint.coef(1,2) = 0.0d0
      mint.coef(2,2) = 0.0d0
C
C     <b>Simulate the outputs of <a href="um510.html">UM510</a></b>
C
      if( kunit.gt.0 ) write(kunit,1000) mint.label,
     :            mint.tzero, mint.norder, mint.epoch,
     :            mint.colat, mint.elong, mint.gmmo, 
     :            mint.saarot
C
C     <b>Initialize the external magnetic field model</b>
C
      CALL <a href="um520.html">UM520</a> (kext, amjd, param, lbext, kunit, ifail)     
      if( ifail.lt.0 )return
C
C     <b>Format</b>
C
 1000 format(/' --- Geomagnetic field model ---',
     : //6x,'Model (sp): ',a32,3x,'Epoch',f6.0,/29x,
     : 'Order + 1 =',i5,/21x,'Calculation epoch =',f7.1,5x,' year',/9x,
     :           'Colatitude of the dipole pole =',f8.2,4x,' deg',/10x,
     :            'Longitude of the dipole pole =',f8.2,4x,' deg',/19x,
     :                         'Earth dipole moment =',f12.6,' G/Re^3',
     :        /10x,'Correction for the SAA drift =',f8.2,4x,' deg')
C
      end
</pre> <h2> <a name="seealso"> See also </a> </h2> <ul>
      <a href="fat04.html">T.04</a> Why are Roederer's <i>L</i><sup>*</sup>
                                   and McIlwain's <i>L</i> parameters
                                   different ? <br>
      <a href="try02.html" rev=toc>Ex. #2</a>, evaluation of the (<i>B</i>, <i>L</i>) 
                                  coordinates<br>   
      <a href="try03.html" rev=toc>Ex. #3</a>, evaluation of the third invariant<br>
</ul> 
<!-- +++ Navigation +++ -->
 
<!-- END OF MAIN CONTENT -->
    </div></div>

    <div id="leftcolumn"><div class="moduletable_menu">

        <h3>UNILIB</h3>
        <ul class="menu">
          <li><a alt="Home" href="home.html">Home</a></li>
          <li><a alt="TOC" href="toc.html">TOC</a></li>      
          <li><a alt="Index" href="index.html">Index</a></li>
          <li><a alt="FAQ" href="faq.html">FAQ</a></li>
        </ul>

        <h3>Links</h3>
        <ul class="menu">
          <li><a href="http://www.aeronomie.be/">BIRA-IASB</a></li>
          <li><a href="http://www.spenvis.oma.be/">SPENVIS</a></li>
        </ul>

    </div></div>
    <div id="footer"><div id="rightfooter">
	    <div class="moduletable">Last update: $Date: 2015-07-31 19:30:01 +0100 (Fri, 31 Jul 2015) $</div>
    </div></div>

  </body>
</html>

