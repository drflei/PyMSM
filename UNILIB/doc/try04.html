<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<!-- $Id: try04.html 11 2015-07-31 18:30:01Z yves.christophe@aeronomie.be $ -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta name="mssmarttagspreventparsing" content="true" />
    <link href="img/unilib_logo_16x16.png" rel="shortcut icon" type="image/gif" />
    <link rel="stylesheet" href="print.css" type="text/css" media="print" />
    <link rel="stylesheet" href="main.css" type="text/css" media="screen" />
    <title>UNILIB</title>
  </head>
  <body>
    <div id="topbar1"><h3 class="small">UNILIB</h3></div>
    <div id="rightcolumn"><div id="content">
      <hr>
      <blockquote><b><font color=red>
        This page essentially documents Unilib version 2.09.
        It may be inaccurate and/or incomplete regarding newer releases!
      </font></b></blockquote>
      <hr>


<!-- BEGIN OF MAIN CONTENT     inside div "rightcolumn/content" -->


	<!-- === UNILIB Library -
      Example 4
   === --> 
<!--meta name="keywords" content="magnetic drift shell,example"-->
 <!-- End of Head, Begin of Body -->
 <h1>
      Example 4 - search the point with the lowest altitude on a 
                  magnetic drift shell
</h1> <h6>
 [ <a href="#description">Description</a>
 | <a href="#source">Source</a>
 | <a href="#results">Results</a>
 <!-- *** Navigation *** -->  
] </h6>
<h2> <a name="description"> Description </a> </h2> <ul>
  In this example, a magnetic drift shell is traced for a given
  (<i>B</i>, <i>L</i>) coordinate and the geographic locations of
  the northern and southern points with the lowest altitude
  are printed. 
  The GSFC 12/66 magnetic field model is used to trace the drift shell.
<p>
  Note that subroutine <a href="ud317.html">UD317</a> can be used instead of
  subroutine <a href="ud310.html">UD310</a> 
  (see <a href="ud310.html#note">note</a>).      
</ul> <h2> <a name="source"> Source </a> </h2> <pre>
      PROGRAM example4
C
      INCLUDE '<a href="structure.html">structure.h</a>'
C
      INTEGER*4    kunit, kinit, ifail, kint, kext
      CHARACTER*32 lbint, lbext
      REAL*8       year, param(10), amjd
      INTEGER*4    knfl, ktyplus
      REAL*8       fbm0, flm0, falt
      TYPE(<a href="structure.html#zgeo">ZGEO</a>) mpn, mps
C
C     <b>initialize variables</b>
C
      DATA kunit, kinit/ 6, 1/
      DATA kint, kext/ 2, 0/
      DATA year, param, amjd/ 1970.d0, 10*0.d0, 0.d0/
C
C     <b>initialize the library</b>
C
      CALL <a href="ut990.html">UT990</a> (kunit, kinit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>set the geomagnetic field model</b>
C     <b>(kint=2, GFSC 12/66)</b>
C
      CALL <a href="um510.html">UM510</a> (kint, year, lbint, kunit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>set no external magnetic field model</b>
C
      CALL <a href="um520.html">UM520</a> (kext, amjd, param,
     :           lbext, kunit, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>trace the drift shell</b>
C
      fbm0          =    0.19d0
      flm0          =    2.0d0
      falt          = -999.9d0
      knfl          =   60
      ktyplus       =    3
C
      CALL <a href="ud310.html">UD310</a> (fbm0, flm0, falt, knfl, 
     :           ktyplus, ifail)
      IF( ifail .LT. 0 )STOP
C
      CALL <a href="ud310.html">UD315</a> (mpn, mps, ifail)
      IF( ifail .LT. 0 )STOP
C
C     <b>write the result</b>
C         
      WRITE (kunit,1000) mpn%radius, mpn%colat, mpn%elong,
     :                   mps%radius, mps%colat, mps%elong
C
 1000 FORMAT(
     :  /25('-'),/'RESULT: coordinates (radius, colatitude, longitude)',
     :   ' of the points with the lowest altitude',
     :  /'North : ', 3f20.10,
     :  /'South : ', 3f20.10,
     :  /25('-') )
C
      END
</pre> <h2> <a name="results"> Results </a> </h2> <pre>

                                    SPENVIS
                                 UNILIB Library
                                 Version 2.22_YCH_initPrep
                           Generated by SPENVIS team


 --- Main control parameters ---

      UC160 (general constants):
                      Geoid major axis = 6378.16     km
                      Geoid minor axis = 6356.77     km
                Mean Earth radius (Re) = 6371.20     km
                  Ecliptic inclination =   23.441512 deg
                 McIlwain Earth dipole =    0.311653 G/Re^3

      UC190 (field line tracing):
                     Maximum step size =  477.8      km at one Re
              Maximum "last" step size =   15.0      km
                     Minimum step size =    2.0      km
                    Altitude precision =  200.       m
              Magnetic field precision =    0.0006   %

      UC192 (magnetic field evaluation):
             Max. geomagnetic latitude =   85.0      deg
                        Minimum radius =    0.157    Re
            (drift shell tracing):
                        Precision on L =    0.10000  %
            Precision on the longitude =    0.05     deg

 --- Geomagnetic field model ---

      Model ( 2): GSFC 12/66 120 Term                Epoch 1960.
                             Order + 1 =   11
                     Calculation epoch = 1970.0      year
         Colatitude of the dipole pole =   11.39     deg
          Longitude of the dipole pole =  -70.21     deg
                   Earth dipole moment =    0.308751 G/Re^3
          Correction for the SAA drift =    0.00     deg

 --- External magnetic field model ---

      Model ( 0): None                            
           Planetary activity index Kp =    0.0      (magnetopause check)

                                  Date =  01-Jan-1950
                        Universal Time =    0.00     hrs
            Greenwich angle of equinox =  100.08     deg
           GEO direction of the Sun, X =   -0.9200
                                     Y =   -0.0131
                                     Z =   -0.3918
                     Dipole tilt angle =  -26.30     deg

-------------------------
<b>RESULT: coordinates (radius, colatitude, longitude) of the points with the lowest altitude
North :      8304.0286038063       59.8894733083      -34.6062461396
South :      7492.5608715705      131.3611545561      -10.3147983474</b>
-------------------------
</pre> 
<!-- +++ Navigation +++ -->
 
<!-- END OF MAIN CONTENT -->
    </div></div>

    <div id="leftcolumn"><div class="moduletable_menu">

        <h3>UNILIB</h3>
        <ul class="menu">
          <li><a alt="Home" href="home.html">Home</a></li>
          <li><a alt="TOC" href="toc.html">TOC</a></li>      
          <li><a alt="Index" href="index.html">Index</a></li>
          <li><a alt="FAQ" href="faq.html">FAQ</a></li>
        </ul>

        <h3>Links</h3>
        <ul class="menu">
          <li><a href="http://www.aeronomie.be/">BIRA-IASB</a></li>
          <li><a href="http://www.spenvis.oma.be/">SPENVIS</a></li>
        </ul>

    </div></div>
    <div id="footer"><div id="rightfooter">
	    <div class="moduletable">Last update: $Date: 2015-07-31 19:30:01 +0100 (Fri, 31 Jul 2015) $</div>
    </div></div>

  </body>
</html>

